(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const i of e.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function r(t){if(t.ep)return;t.ep=!0;const e=n(t);fetch(t.href,e)}})();window.reportarIncidente=function(){window.location.href="formulario.html"};window.verIncidentes=function(){window.location.href="tablaincidentes.html"};window.redirigir=function(){window.location.href="index.html"};window.enviarReporte=async function(s){try{const n=await(await fetch("/api.php?action=registrar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).text();let r;try{r=JSON.parse(n)}catch{throw console.error("Respuesta NO JSON:",n),new Error("Respuesta del servidor no es JSON")}if(console.log("API registrar ->",r),!r.ok)throw new Error(r.error||"Error desconocido");return r.id}catch(o){return console.error("Error al guardar:",o),alert("No se pudo guardar el reporte: "+o.message),null}};window.cargarIncidentes=async function(){try{const o=await(await fetch("/api.php?action=listar")).json();if(!o.ok)throw new Error(o.error||"Error listando");const n=o.denuncias||{},r=document.getElementById("incidentes-lista");if(!r)return;r.innerHTML="",Object.entries(n).forEach(([t,e])=>{const i=document.createElement("tr"),c=e.estado||"Pendiente",a=e.tipo||"",d=e.fecha||"",l=e.ubicacion||"",u=e.region?` (${e.region})`:"",f=e.detalles&&e.detalles.trim()?e.detalles:"—";i.innerHTML=`
        <td>${c}</td>
        <td>${t}</td>
        <td>${a}</td>
        <td>${d}</td>
        <td>${l}${u}</td>
        <td><button class="btn-ver-mas" data-id="${t}" title="${f}">Ver más</button></td>
      `,r.appendChild(i)}),r.onclick=t=>{const e=t.target.closest(".btn-ver-mas");e&&alert(e.title||"Sin descripción")}}catch(s){console.error(s)}};
